=  Сценарий

== Пиктограмма функции

image:Buttons/Function_Script.png[image]

== Общее описание функции

Функция [.keyword]*Сценарий* позволяет выполнить в рамках процесса произвольный код на языке платформы .NET (C# или VB.NET).

== Сценарии использования

Функция должна содержать программный код, описывающий единственный стандартный метод:

[source,pre,codeblock]
----
public void Execute (ProcessInfo process, PassState passInfo)
----

При поступлении управления бизнес-процессом на функцию сценария будет запускаться этот метод. Его входные параметры содержат ссылки на информацию о процессе (process) и данные о текущем проходе (passInfo). Подробнее см. документацию разработчика.

Функция может оперировать объектами бизнес-процесса (переменные, функции, и шлюзы); добавлять, удалять и изменять значения переменных, а также взаимодействовать с любыми внешними системами (напрямую или через шлюзы).

== Настройка параметров

image::Parameters_Script.png[[.fig--title-label]#Рис. 1. # Окно "Сценарий". Вкладка "Параметры"]

На вкладке [.keyword]*Параметры* указываются программные модули, необходимые для работы сценария, язык сценария (С# или VB.NET) и вводится текст сценария, согласно которому функция автоматически генерирует шаблон сценария на выбранном языке.

Не добавлять ссылку на DocsVision. Objectmanager.Interop.dll::
  При установке флага в сценарий не будет добавлена ссылка на устаревший интероп к COM-библиотеке [.keyword .parmname]_ObjectManager_. Вместо этого будет добавлена ссылка на библиотеку [.keyword .parmname]_DocsVision.Platform.ObjectManager_, которую теперь можно будет использовать как и все другие типы в пространстве имен global. Ранее она использовалась через псевдоним mOM, из-за совпадения пространств имен с библиотекой [.keyword .parmname]_DocsVision.ObjectManager.Interop.dll_. Данная опция упрощает использование библиотеки [.keyword .parmname]_DocsVision.Platform.ObjectManager_ в новых сценариях, и позволяет обеспечить совместимость со старыми сценариями. По умолчанию в новых функциях опция включена, в существующих  – выключена.
Использовать простой редактор сценариев::
  Позволяет принудительно включить использование старого редактора. В первую очередь эта опция предназначена для использования в случаях, когда новый редактор по каким-то причинам работает некорректно.
Текст сценария::
  При нажатии на кнопку открывается окно [.keyword .wintitle]*Текст сценария*, в котором выбирается язык сценария и вводится его текст.
  +
  В данном окне используется редактор кода с подсветкой синтаксиса. Данный редактор сценариев автоматически используется при установленном приложении [.dfn .term]_BackOffice_.

[NOTE]
====
[.note__title]#Прим.:# Новый редактор сценариев (с подсветкой синтаксиса) доступен на сервере при наличии установленного приложения [.dfn .term]_Управление процессами_. На компьютерах, где установлены только клиентские компоненты, будет использоваться предыдущая версия редактора, а флаг [.ph .uicontrol]*Использовать простой редактор сценариев* будет не активен.
====

*На уровень выше:* xref:Basic_Functions.adoc[Базовые функции]
