= Мониторинг сообщений

== Пиктограмма функции

image:Buttons/Function_Monitiring_Messages.png[image]

== Общее описание функции

Функция *Мониторинг сообщений* позволяет обнаруживать все входящие сообщения электронной почты, отвечающие определенным критериям, а также обнаружить изменение статуса какого-либо сообщения (например, было ли сообщение прочитано). В настройках функции мониторинга указывается, в какую переменную процесса будет возвращена ссылка на объект поиска.

== Настройка параметров

image::Parameters_Monitiring_Messages.png[Свойства функции "Мониторинг сообщений". Вкладка "Параметры"]

На вкладке *Параметры* окна свойств функции указываются параметры мониторинга почтовых сообщений.

Очищать историю мониторинга::
  Значение или переменная бизнес-процесса типа _Да/Нет_, указанное в данном поле определяет, будет ли удаляться история мониторинга. При сохранении истории (значение поля `Нет`) при повторном выполнении функции будет производиться мониторинг только вновь появившихся сообщений; при удалении истории (значение поля `Да`) при повторном выполнении функции будут обнаружены все сообщения, найденные в прошлый раз, а также все вновь появившиеся сообщения.
При неудаче активировать связь::
  В поле вносится название функции, которой будет передано управление процессом в случае если объект с нужными свойствами не будет найден при однократном мониторинге. Поле не обязательно для заполнения.

[NOTE]
====
Для корректной работы мониторинга необходимо, чтобы между функцией мониторинга и функцией, указанной в поле *При неудаче активировать связь*, была установлена связь типа _При успехе_, иначе при неудаче мониторинга процесс будет остановлен из-за ошибки. Связь типа _При ошибке_ между функцией мониторинга и указанной в поле *При неудаче активировать связь* функцией устанавливают, если управление должно перейти к ней в случае невозможности мониторинга (например, недоступности его объекта); иначе в этом случае процесс будет остановлен из-за ошибки. При необходимости связи типа _При ошибке_ и _При успехе_ можно установить одновременно.
====

Мониторинг всех входящих сообщений::
  Переключатель указывает, что будет осуществляться мониторинг всех входящих сообщений электронной почты (например, обнаруживаться появление новых сообщений, соответствующих заданным критериям.
Сохранять сообщения в::
  Переменная бизнес-процесса типа _Почтовое сообщение_, в которую будут возвращаться ссылки на сообщения, обнаруженные в процессе *Мониторинга всех входящих сообщений*.
Мониторинг изменений конкретного сообщения::
  Переключатель указывает, что будет осуществляться мониторинг
Следить за сообщением::
  Переменная бизнес-процесса типа _Почтовое сообщение_, значение которой указывает, мониторинг изменений какого сообщения будет осуществляться при установленном переключателе *Мониторинг изменений конкретного сообщения*.

[NOTE]
====
Для сохранения нескольких сообщений используйте переменную-коллекцию.
====

Секция *Параметры мониторинга* содержит параметры мониторинга сообщений.

Тема сообщения::
  Последовательность символов, поиск которой будет осуществляться в теме почтового сообщения; может быть представлена как значением, непосредственно введенным в данное поле, так и строковой переменной бизнес-процесса.
Только непрочитанные::
  Значение типа `Да`/`Нет`, указывающее, будет производиться мониторинг всех сообщений, или только вновь поступивших (непрочитанных). Значение указывается непосредственно или выбирается с помощью переменной типа _Да/Нет_.
Дата отправки (с... по...)::
  В полях выбирается период, в течение которого с почтового сервера были отправлены сообщения, предназначенные для мониторинга. Значения данных полей могут как непосредственно выбираться в поле, так и указываться с помощью переменной бизнес-процесса типа _Дата/Время_.
Отправитель::
  Последовательность символов, поиск которой будет осуществляться в поле сообщения *Отправитель*. Вводится с клавиатуры или указывается с помощью переменной типа _Строка_.
Получатели::
  Последовательность символов, поиск которой будет осуществляться в поле сообщения *Получатель*. Вводится с клавиатуры или указывается с помощью переменной типа _Строка_.
Текст сообщения::
  Последовательность символов, поиск которой будет осуществляться в тексте почтового сообщения. Вводится с клавиатуры или указывается с помощью переменной типа _Строка_.
Важность::
  Важность полученного сообщения. Указывается с помощью счетчика.
Размер от (байт)::
  минимальный размер почтового сообщения. Указывается с помощью счетчика.

При мониторинге электронных писем функция выполняет сравнение строки, указанной в поле *Получатели*, со строкой, описывающей получателей письма. В связи с этим не рекомендуется искать письма, предназначенные сразу для нескольких получателей, так как результат поиска будет зависеть от порядка следования имен получателей в каждом конкретном письме. Это ограничение будет снято в одной из следующих версий системы.

Если для получения писем используется сервер типа POP3 или Exchange Web Services, то параметры *Только непрочитанные* и *Отправитель* при мониторинге учитываться не будут.
