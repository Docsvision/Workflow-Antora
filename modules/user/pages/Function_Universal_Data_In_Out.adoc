=  Универсальный обмен данными

== Пиктограмма функции

image:Buttons/Function_Universal_Data_In_Out.png[image]

== Общее описание функции

Функция универсального обмена данными, как и функция обмена данными между переменными, предназначена для присвоения переменной значения (как непосредственно заданного, так и значения другой переменной), однако, в отличие от предыдущей функции, она предоставляет несколько иные возможности.

== Сценарии использования

При [.keyword]*Универсальном обмене данными* возможна передача значений как между внутренними переменными бизнес-процесса, так и между объектами и отдельными атрибутами объектов шлюзов (при обязательном соответствии типов переменных, например, значение свойства карточки [.dfn .term]_Docsvision_ может быть присвоено строковому полю любой другой переменной).

Если в обмене данными участвует сложная переменная (карточка [.dfn .term]_Docsvision_, почтовое сообщение и др.), функция универсального обмена данными позволяет передавать переменной-приемнику не полное значение (например, карточки), а какого-либо ее элемента – секции, строки и т. д.; при этом следует обращать особое внимание на типы переменных обмена. При несоответствии типов переменной-приемника и переменной-источника бизнес-процесс будет завершен по ошибке (за исключением некоторых общепринятых допустимых случаев, например, присвоения переменной дробного типа целочисленного значения).

Функция [.keyword]*Универсальном обмене данными* может выполнять неограниченное количество операций по присвоению значений любым переменным; чтобы избежать путаницы в дальнейшем при тестировании и работе с бизнес-процессом рекомендуется дать подробное описание каждой из них.

== Настройка параметров

image::Parameters_Universal_Data_In_Out.png[[.fig--title-label]##Рис. 1. ##Окно "Универсальный обмен данными". Вкладка "Параметры"]

На вкладке [.keyword]*Параметры* описаны все выполняемые функцией шаги обмена данными. Имеющиеся на вкладке кнопки используются согласно обычному принципу: [.ph .uicontrol]*Добавить*, [.ph .uicontrol]*Изменить* и [.ph .uicontrol]*Удалить* позволяют соответственно определить новый шаг обмена, а также изменить или удалить существующий; кнопка [.ph .uicontrol]*Копировать* предоставляет возможность продублировать шаг обмена в списке, например, в целях его последующего редактирования; кнопки [.ph .uicontrol]*Вверх* и [.ph .uicontrol]*Вниз* – изменять порядок следования шагов обмена.

При нажатии кнопок [.ph .uicontrol]*Добавить* или [.ph .uicontrol]*Изменить* открывается диалоговое окно [.keyword .wintitle]*Настройки шага обмена*, позволяющее соответственно добавить новый шаг обмена данными или изменить уже существующий. Кнопки [.ph .uicontrol]*Вверх* и [.ph .uicontrol]*Вниз* этого окна служат для быстрого перехода к предыдущему и следующему шагам обмена соответственно и активизируются, если такие шаги уже настроены.

image::Parameters_Universal_DataInOut_ExchangeStep.png[[.fig--title-label]##Рис. 2. ##Окно "Настройки шага обмена"]

Настройка шагов обмена подразумевает указание переменной-источника и переменной-приемника; эти действия аналогичны. В каждом из полей выбор значения или переменной осуществляется из списка, раскрывающегося при нажатии кнопки image:Buttons/Three_Dots.png[image]. Пока не указаны все необходимые настройки шага обмена (типы источника и приемника, а также переменная-приемник и переменная-источник или ее значение, кнопка [.ph .uicontrol]*ОK* остается недоступной для выбора.

Тип объекта, указываемый в полях [.keyword]*Тип*, выбирается из дерева всех доступных типов. До указания типа последующие поля недоступны для заполнения.

image::Objects_types_tree.png[[.fig--title-label]##Рис. 3. ##Дерево типов объектов]

После того как тип указан, в выпадающем списке поля [.keyword]*Переменная* окажутся доступными для выбора все объявленные переменные бизнес-процесса указанного типа. Кроме того, значение можно ввести вручную (для простых типов) или выбрать существующий объект (соответствующего типа).

В качестве источника могут быть указаны:

* переменная любого типа;
* объект шлюза;
* простое свойство (поле) объекта шлюза;
* пользовательское свойство (поле) объекта шлюза;
* индексированное свойство (поле) объекта шлюза;
* коллекционное свойство (поле) объекта шлюза;
* пустое значение;
* введенное с клавиатуры значение простого типа.

В качестве приемника могут указываться:

* переменные;
* свойства (поля) объекта, у которых отсутствует флаг «только чтение»;
* пустое значение (необходимо для случая, если в источнике выполняется операция над коллекционным свойством).

Поле [.keyword]*Свойство* не является обязательным и становится доступным для выбора, если только в предыдущем поле был указан объект или составной тип переменной (обладающий свойствами); заполнение данного поля обеспечивает передачу значения не всей составной переменной, а только одного ее свойства. Кроме того, если указанное свойство является коллекционным, помимо передачи его значения другой переменной возможно проведение над ним действия, определенного для коллекций:

* получить число элементов;
* получить элемент;
* получить все;
* добавить новый элемент;
* добавить элемент;
* удалить элемент;
* очистить коллекцию.

Для операций, не возвращающих значений, секция описания переменной-приемника не заполняется; для операций, возвращающих какое-либо значение, в секции описания должна указываться принимающая переменная соответствующего типа. Из перечисленных операций возвращаемое значение имеют:

* получение числа элементов в коллекции;
* получение элемента коллекции;
* добавление нового элемента коллекции;
* добавление существующего элемента коллекции.

После указания всех параметров рекомендуется ввести в поле [.keyword]*Описание* подробное описание и назначение операции, выполняемой на данном шаге обмена: это облегчит корректировку шагов при последующем редактировании бизнес-процесса и исправлении ошибок.

Завершив все описанные действия, нажмите кнопку [.keyword]*ОК*.

*На уровень выше:* xref:Basic_Functions.adoc[Базовые функции]
