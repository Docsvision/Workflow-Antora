= Сервис для работы с карточкой документа

[cols="35%,40%,25%",options="header"]
|===
|Функция |Параметры функции |Тип значения параметра

.3+|Блокировка основного файла
|Документ

|Файл

|Путь к файлу

|Карточка DV

|Строка секции карточки DV

|Строка

.3+|Блокировка основного файла с сохранением во временную директорию |Документ

|Файл

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Строка, выходной параметр

.3+|Добавление дополнительного файла |Документ

|Путь к файлу

|Возвращаемое значение

|Карточка DV

|Строка

|Строка секции карточки DV, выходной параметр

.3+|Добавление дополнительного файла по версионному файлу |Документ

|Карточка файла с версиями

|Возвращаемое значение

|Карточка DV

|Файл DV

|Строка секции карточки DV, выходной параметр

.3+|Добавление дополнительных файлов |Документ

|Пути к файлам

|Возвращаемое значение

|Карточка DV

|Строка, коллекция

|Строка секции карточки DV, выходной параметр, коллекция

.4+|Добавление комментария к основному файлу |Документ

|Файл

|Комментарий

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Строка

|Да/Нет, выходной параметр

.3+|Добавление основного файла |Документ

|Путь к файлу

|Возвращаемое значение

|Карточка DV

|Строка

|Строка секции карточки DV, выходной параметр

.3+|Добавление основных файлов |Документ

|Пути к файлам

|Возвращаемое значение

|Карточка DV

|Строка, коллекция

|Строка секции карточки DV, выходной параметр, коллекция

.4+|Загрузка новой версии основного файла документа |Документ

|Файл

|Путь к файлу

|Сотрудник

|Карточка DV

|Строка секции карточки DV

|Строка

|Сотрудник DV

.2+|Отмена блокировки основного файла |Документ

|Файл

|Карточка DV

|Строка секции карточки DV

.3+|Переименовать дополнительный файл |Документ

|Файл

|Значение

|Карточка DV

|Строка секции карточки DV

|Новое название файла

.3+|Переименовать основной файл |Документ

|Файл

|Значение

|Карточка DV

|Строка секции карточки DV

|Новое название файла

.2+|Получить все файлы документа |Документ

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV, выходной параметр, коллекция

.2+|Получить дополнительные файлы |Документ

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV, выходной параметр, коллекция

.2+|Получить карточку файла с версиями из дополнительного файла |Документ

|Возвращаемое значение

|Строка секции карточки DV

|Файл DV, выходной параметр

.2+|Получить карточку файла с версиями из дополнительного файла |Документ

|Возвращаемое значение

|Строка секции карточки DV

|Файл DV, выходной параметр

.2+|Получить карточку файла с версиями из файла документа |Файл

|Возвращаемое значение

|Строка секции карточки DV

|Файл DV, выходной параметр

.2+|Получить основные файлы |Документ

|Возвращаемое значение

|Карточка DV

|Строка секции карточки, выходной параметр, коллекция

.2+|Применить настройки из справочника видов |Документ

|Вид

|Карточка DV

|Строка секции карточки DV

.2+|Проверка блокировки основного файла документа |Файл

|Возвращаемое значение

|Строка секции карточки DV

|Да/Нет, выходной параметр

.4+|Проверка возможности блокировки основного файла документа |Документ

|Файл

|Принудительно разблокировать

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Да/Нет

|Да/Нет, выходной параметр

.3+|Проверка возможности добавления основного файла |Документ

|Карточка файла с версиями

|Возвращаемое значение

|Карточка DV

|Файл DV

|Да/Нет, выходной параметр

.2+|Проверка возможности разблокировки основного файла без сохранения изменений |Файл

|Возвращаемое значение

|Строка секции карточки DV

|Да/Нет, выходной параметр

.3+|Проверка возможности разблокировки основного файла с сохранением изменений |Документ

|Файл

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Да/Нет, выходной параметр

.4+|Проверка возможности редактирования основного файла |Документ

|Файл

|Принудительно разблокировать

|Возвращаемое значение

|Карточка DV

|Срока секции карточки DV

|Да/Нет

|Да/Нет, выходной параметр

.3+|Проверка возможности удаления основного файла |Документ

|Файл

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Да/Нет, выходной параметр

.3+|Проверка возможности удаления основных файлов |Документ

|Файлы

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV, коллекция

|Да/Нет, выходной параметр

.3+|Проверка наличия подписи у основного файла |Документ

|Файл

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Да/Нет, выходной параметр

.3+|Проверка наличия подписи у основных файлов |Документ

|Подпись

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Да/Нет, выходной параметр

.3+|Редактирование основного файла |Документ

|Файл

|Путь к файлу

|Карточка DV

|Строка секции карточки DV

|Строка

.2+|Свободен ли основной файл |Файл

|Возвращаемое значение

|Строка секции карточки DV

|Да/Нет, выходной параметр

.2+|Свободны ли основные файлы |Файлы

|Возвращаемое значение

|Строка секции карточки DV, коллекция

|Да/Нет, выходной параметр

.3+|Снятие блокировки с основного файла с сохранением изменений |Документ

|Файл

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Да/Нет, выходной параметр

.6+|Снятие блокировки с основного файла с сохранением изменений с добавлением новой версии |Документ

|Файл

|Уровень

|Комментарий

|Указывает добавлять комментарий к версии файла или файлу

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Целое

С|трока

|Да/Нет

|Да/Нет, выходной параметр

.7+|Снятие блокировки с основного файла с сохранением изменений |Документ

|Файл

|Уровень

|Комментарий

|Указывает добавлять комментарий к версии файла или файлу

|Путь к файлу

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Целое

|Строка

|Да/Нет

|Строка

|Да/Нет, выходной параметр

.4+|Снятие блокировки с основного файла с сохранением изменений по пути к файлу |Документ

|Файл

|Путь к файлу

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Строка

|Да/Нет, выходной параметр

.7+|Снятие блокировки с основного файла с сохранением изменений по пути к файлу с созданием новой версии |Документ

|Файл

|Уровень

|Комментарий

|Указывает добавлять комментарий к версии файла или файлу

|Путь к файлу

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Целое

|Строка

|Да/Нет

|Строка

|Да/Нет, выходной параметр

.2+|Создание карточки документа |Путь к файлу

|Возвращаемое значение

|Строка

|Карточка DV, выходной параметр

.3+|Создание карточки документа определенного вида |Путь к файлу

|Вид

|Возвращаемое значение

|Строка

|Строка секции карточки DV

|Карточка DV, выходной параметр

.3+|Сохранение дополнительного файла на диск |Документ

|Файл

|Путь к файлу

|Карточка DV

|Строка секции карточки DV

|Строка

.3+|Сохранение дополнительного файла на диск по пути |Документ

|Файл

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Строка, выходной параметр

.3+|Сохранение основного файла на диск |Документ

|Файл

|Возвращаемое значение

|Карточка DV

|Строка секции карточки DV

|Строка, выходной параметр

.3+|Сохранение основного файла на диск по пути |Документ

|Файл

|Путь к файлуlink:fntarg_1[^1^]

|Карточка DV

|Строка секции карточки DV

|Строка

.2+|Удаление дополнительного файла |Документ

|Файл

|Карточка DV

|Строка секции карточки DV

.2+|Удаление основного файла |Документ

|Файл

|Карточка DV

|Строка секции карточки DV

.2+|Экспорт документа в adoc |Документ

|Возвращаемое значение

|Карточка DV

|Строка, выходной параметр

.2+|Экспорт документа в adoc файл |Документ

|Возвращаемое значение

|Карточка DV

|Строка, выходной параметр
|===

Значение переменной `Файл` с типом _Строка секции карточки DV_ может быть получено с помощью функции _Универсальный обмен данными_ в два шага:

. Секция карточки, содержащая ссылку на Файл, записывается в переменную процесса типа Секция карточки DV
. Строки из подготовленной переменной сохраняются в переменную процесса с типом Строка секции карточки DV/Документ: Файлы.

link:fnsrc_1[^1^] Путь должен содержать имя файла (например, C:\Test\ServerLog.txt).
