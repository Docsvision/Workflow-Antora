= Сценарий

.Пиктограмма функции
image::buttons/script.png[Лист]

== Общее описание функции

Функция _Сценарий_ позволяет выполнить в рамках процесса произвольный код на языке платформы .NET (C# или VB.NET).

== Сценарии использования

Функция должна содержать программный код, описывающий единственный стандартный метод:

[source,csharp]
----
public void Execute (ProcessInfo process, PassState passInfo)
----

При поступлении управления бизнес-процессом на функцию сценария будет запускаться этот метод. Его входные параметры содержат ссылки на информацию о процессе (`process`) и данные о текущем проходе (`passInfo`). Подробнее см. xref:programmer:bpms:scenarios-develop.adoc[документацию разработчика].

Функция может оперировать объектами бизнес-процесса (переменные, функции, и шлюзы). Добавлять, удалять и изменять значения переменных, а также взаимодействовать с любыми внешними системами (напрямую или через шлюзы).

== Настройка параметров

.Окно "Сценарий". Вкладка "Параметры"
image::script-params.png[Окно "Сценарий". Вкладка "Параметры"]

На вкладке _Параметры_ указываются программные модули, необходимые для работы сценария, язык сценария (С# или VB.NET) и вводится текст сценария, согласно которому функция автоматически генерирует шаблон сценария на выбранном языке.

Не добавлять ссылку на {dv}. Objectmanager.Interop.dll::
Когда флаг установлен, в сценарий не будет добавлена ссылка на устаревший интероп к COM-библиотеке _ObjectManager_. Вместо этого будет добавлена ссылка на библиотеку `{dv}.Platform.ObjectManager`, которую теперь можно будет использовать как и все другие типы в пространстве имен global. +
Ранее библиотека использовалась через псевдоним `mOM`, из-за совпадения пространств имен с библиотекой _{dv}.ObjectManager.Interop.dll_. +
Данная опция упрощает использование библиотеки `{dv}.Platform.ObjectManager` в новых сценариях и позволяет обеспечить совместимость со старыми сценариями. По умолчанию в новых функциях опция включена, в существующих -- выключена.

Использовать простой редактор сценариев::
Позволяет принудительно включить использование старого редактора. В первую очередь эта опция предназначена для использования в случаях, когда новый редактор по каким-то причинам работает некорректно.

Текст сценария::
При нажатии на кнопку открывается окно _Текст сценария_, в котором выбирается язык сценария и вводится его текст.
+
В данном окне используется редактор кода с подсветкой синтаксиса. Данный редактор сценариев автоматически используется, если установлен модуль _{bo}_.

[NOTE]
====
Новый редактор сценариев (с подсветкой синтаксиса) временно недоступен в данной версии модуля. Всегда используется предыдущая версия редактора.
// на сервере при наличии установленного приложения _{wf}_.
На компьютерах, где установлены только клиентские компоненты, будет использоваться предыдущая версия редактора, а флаг `*Использовать простой редактор сценариев*` будет не активен.
====
