= Мониторинг сообщений

.Пиктограмма функции
image::buttons/message-monitoring.png[Конверт с очками]

== Общее описание функции

Функция _Мониторинг сообщений_ позволяет обнаруживать все входящие сообщения электронной почты, отвечающие определенным критериям, а также обнаружить изменение статуса какого-либо сообщения (например, было ли сообщение прочитано).

В настройках функции мониторинга указывается, в какую переменную процесса будет возвращена ссылка на объект поиска.

[#parameter-settings]
== Настройка параметров

.Свойства функции "Мониторинг сообщений". Вкладка "Параметры"
image::message-monitoring-properties.png[Свойства функции "Мониторинг сообщений". Вкладка "Параметры"]

.На вкладке "Параметры" окна свойств функции указываются параметры мониторинга почтовых сообщений:
Очищать историю мониторинга::
Значение или переменная бизнес-процесса типа _Да/Нет_, указанное в данном поле определяет, будет ли удаляться история мониторинга. +
При сохранении истории (значение поля *_Нет_*) при повторном выполнении функции будет производиться мониторинг только вновь появившихся сообщений. При удалении истории (значение поля *_Да_*) при повторном выполнении функции будут обнаружены все сообщения, найденные в прошлый раз, а также все вновь появившиеся сообщения.

При неудаче активировать связь::
В поле вносится название функции, которой будет передано управление процессом в случае если объект с нужными свойствами не будет найден при однократном мониторинге. Поле необязательно для заполнения.

[NOTE]
====
Для корректной работы мониторинга необходимо, чтобы между функцией мониторинга и функцией, указанной в поле _При неудаче активировать связь_, была установлена связь типа _При успехе_. +
В противном случае при неудаче мониторинга процесс будет остановлен из-за ошибки.

Связь типа _При ошибке_ между функцией мониторинга и указанной в поле _При неудаче активировать связь_ функцией устанавливают, если управление должно перейти к ней в случае невозможности мониторинга, например, недоступности его объекта. +
В противном случае процесс будет остановлен из-за ошибки.

При необходимости связи типа _При ошибке_ и _При успехе_ можно установить одновременно.
====

Мониторинг всех входящих сообщений::
Переключатель указывает, что будет осуществляться мониторинг всех входящих сообщений электронной почты. Например, обнаруживаться появление новых сообщений, соответствующих заданным критериям.

Сохранять сообщения в::
Переменная бизнес-процесса типа _Почтовое сообщение_, в которую будут возвращаться ссылки на сообщения, обнаруженные в процессе _Мониторинга всех входящих сообщений_.

Мониторинг изменений конкретного сообщения::
Переключатель указывает, что будет осуществляться мониторинг.

Следить за сообщением::
Переменная бизнес-процесса типа _Почтовое сообщение_, значение которой указывает, мониторинг изменений какого сообщения будет осуществляться при установленном переключателе *Мониторинг изменений конкретного сообщения*.
+
[NOTE]
====
Для сохранения нескольких сообщений используйте переменную-коллекцию.
====

.Секция "Параметры мониторинга" содержит параметры мониторинга сообщений
Тема сообщения::
Последовательность символов, поиск которой будет осуществляться в теме почтового сообщения. +
Может быть представлена как значением, непосредственно введенным в данное поле, так и строковой переменной бизнес-процесса.

Только непрочитанные::
Значение типа `Да/Нет`, указывающее, будет производиться мониторинг всех сообщений, или только вновь поступивших (непрочитанных). +
Значение указывается непосредственно или выбирается с помощью переменной типа _Да/Нет_.

Дата отправки (с... по...)::
В полях выбирается период, в течение которого с почтового сервера были отправлены сообщения, предназначенные для мониторинга. +
Значения данных полей могут как непосредственно выбираться в поле, так и указываться с помощью переменной бизнес-процесса типа _Дата/Время_.

Отправитель::
Последовательность символов, поиск которой будет осуществляться в поле сообщения _Отправитель_. +
Вводится с клавиатуры или указывается с помощью переменной типа _Строка_.

Получатели::
Последовательность символов, поиск которой будет осуществляться в поле сообщения _Получатель_. +
Вводится с клавиатуры или указывается с помощью переменной типа _Строка_.

Текст сообщения::
Последовательность символов, поиск которой будет осуществляться в тексте почтового сообщения. +
Вводится с клавиатуры или указывается с помощью переменной типа _Строка_.

Важность::
Важность полученного сообщения. Указывается с помощью счетчика.

Размер от (байт)::
Минимальный размер почтового сообщения. Указывается с помощью счетчика.

При мониторинге электронных писем функция выполняет сравнение строки, указанной в поле _Получатели_, со строкой, описывающей получателей письма. +
В связи с этим не рекомендуется искать письма, предназначенные сразу для нескольких получателей, так как результат поиска будет зависеть от порядка следования имен получателей в каждом конкретном письме. Это ограничение будет снято в одной из следующих версий системы.

Если для получения писем используется сервер типа POP3 или Exchange Web Services, то параметры _Только непрочитанные_ и _Отправитель_ при мониторинге учитываться не будут.
