= Дополнительные данные о задании

Вкладка _Дополнительные данные_ позволяет указать множество конкретизирующих настроек задания при помощи диалоговых окон, открывающихся при нажатии кнопок вкладки.

.Свойства функции "Задание". Вкладка "Дополнительные данные"
image::task-additional-properties.png[Свойства функции "Задание". Вкладка "Дополнительные данные"]

[#performance-parameters]
== Параметры исполнения

В окне _Параметры исполнения задания_ указываются переменные бизнес-процесса соответствующих типов, в которые будут возвращаться данные о ходе исполнения: исполнитель, состояние и т.д. в процессе выполнения задания. Окно _Параметры исполнения задания_ открывается при нажатии кнопки *Исполнение...* на вкладке _Дополнительные данные_.

.Окно "Параметры исполнения задания"
image::task-performance-parameters.png[Окно "Параметры исполнения задания"]

Реальная дата начала::
Переменная типа _Дата/Время_.

Реальная дата завершения::
Переменная типа _Дата/Время_. Переменная не должна совпадать с переменной _Реальная дата начала_.

Реальная длительность::
Рассчитывается после выполнения задания с помощью подключенного к бизнес-процессу бизнес-календаря. Если бизнес-календарь не подключен, значение указывается с помощью целочисленной переменной.

Реальная трудоемкость::
После завершения задания переносится из поля _Фактическая трудоемкость_ карточки задания.

Состояние задания::
Переменная типа _Целое_.

Текущий исполнитель::
Переменная типа _Сотрудник DV_.

Процент исполнения::
Переменная типа _Целое_.
+
.Может принимать следующие значения:
* 1 -- К исполнению.
* 2 -- Не начато.
* 3 -- В работе.
* 4 -- Отложено.
* 5 -- Завершено.
* 6 -- Отказ от выполнения.
* 7 -- Отозвано.
* 8 -- Делегировано -- не начато.
* 9 -- Делегировано -- в работе.
* 10 -- Делегировано -- отложено.
* 11 -- Делегировано -- к исполнению.
* 12, 13 -- Делегировано -- обрабатывается сервером.
* 14 -- Делегировано -- возвращено с делегирования.
+
Переменная отчета::
Переменная типа _Строка_, в которую возвращается вводимый исполнителем отчет. +
Если функция задания является частью цикла, входящего в состав бизнес-процесса, при повторной (и всех последующих) передаче ей управления система не создает новой карточки задания, а обновляет статус уже имеющейся (`К исполнению`). +
При этом исполнитель сможет обновить отчет об исполнении, только удаляя уже имеющийся.

Ссылка на задание::
Переменная типа _Карточка DV_, содержащая ссылку на создаваемую функцией карточку задания.

Завершивший исполнитель::
Переменная типа _Сотрудник DV_.

Завершено ответственным исполнителем::
Переменная типа _Сотрудник DV_.

Завершено функцией управления заданием::
Переменная типа _Да / Нет_. Переменная принимает значение _Да_, если задание было завершено не вручную исполнителем, а автоматически, через функцию управления заданием.

[#rights-logs]
== Права и журналы

Окно _Права и журналы_ открывается при нажатии кнопки *Права...* на вкладке _Дополнительные данные_. Окно содержит группы флагов, описанные ниже.

.Окно "Права и журналы"
image::rights-logs-window.png[Окно "Права и журналы"]

.Группа "Маршрутизация заданий" объединяет флаги, определяющие параметры рассылки заданий.
Только к ознакомлению::
В задании будет доступен только просмотр, без возможности редактирования. В карточке _Задание_ будут отсутствовать кнопки *В работу* и *Отложить*.

Добавлять новые документы из процесса перед отправкой задания::
При установке флага перед отправкой задания из процесса будут добавляться новые документы

Не удалять задание при удалении бизнес-процесса::
Флаг запрещает удаление задания при удалении бизнес-процесса.

Отправлять содержание задания в письме как HTML::
Устанавливать флаг следует при выбранном для задания способе маршрутизации *_Ссылка на задание_*. Тогда в полученном сообщении электронной почты URL-ссылка, по которой можно перейти к карточке задания, будет заменена гиперссылкой с текстом `"Название задания"`.

.В группу "Исполнение задания" входят опции, определяющие параметры исполнения заданий.
Ответственный исполнитель может изменить дату завершения::
У Ответственного исполнителя будет доступна операция изменения даты завершения задания.

Исполнитель может изменить дату завершения::
У Исполнителя будет доступна операция изменения даты завершения задания.

Исполнитель может отказаться от исполнения::
У исполнителя в карточке будет доступна команда отказа от исполнения задания.

Исполнитель может добавлять файлы к заданию::
При этом из раскрывающихся списков при необходимости выбираются:
+
* *Переменная для файлов* -- имена переменных, в которые будут сохранены файлы, добавленные пользователем.
* *Тип версий файлов*.

Исполнитель может удалять файлы::
Исполнитель может удалять файлы, приложенные к карточке задания и отображаемые на вкладке _Файлы и ссылки_.

Исполнитель может открыть карточку бизнес-процесса::
У Исполнителя в карточке будет доступна команда для открытия карточки активного бизнес-процесса.

Исполнитель может просматривать историю исполнения задания::
У Исполнителя в карточке будет доступна операция просмотра истории исполнения задания.

Учитывать бизнес-календарь исполнителя::
Указывает, что личный календарь исполнителя будет использован при высчитывании дат начала и конца исполнения задания. Если такой календарь явно не назначен, для тех же целей будет использован календарь подразделения исполнителя (если он определен) или системный календарь (в отсутствие календаря подразделения).
+
.Для альтернативного исполнения действуют ограничения:
* Если исполнителем задания является некоторое _подразделение DV_, то будет использован календарь этого подразделения.
* Если в задании указано больше одного исполнителя, то будет использован календарь бизнес-процесса или календарь по умолчанию.
* Если в качестве исполнителя задания названы _группа DV_ или _роль DV_, то будет использован календарь бизнес-процесса или календарь по умолчанию.

Шаблон текста заданий::
Шаблон текста, который увидит исполнитель в задании.
+
В секции _Журналы переменных для показа в задании_ определяются настройки журналирования задания.

Журналы переменных для показа в задании::
Список переменных, для которых при объявлении был указан параметр `*Сохранять историю значений*`. Установка флагов напротив какой-либо переменной позволит просматривать историю изменения значений переменной на отдельной вкладке карточки _Задание_.

Имя журналов::
Имя журналов, в которых будет сохраняться история значений указанных переменных. Поле необязательно для заполнения.

[NOTE]
====
Если флаг `*Учитывать бизнес-календарь исполнителя*` установлен, а указанная на вкладке _Основная_ дата начала задания меньше даты запуска бизнес-процесса, то дата завершения будет рассчитана от даты запуска экземпляра бизнес-процесса.
====

[NOTE]
====
Отказ от выполнения задания рекомендуется использовать в исполнении задания бизнес-процесса следующим образом: в бизнес-процессе можно создать целочисленную переменную, указать её в качестве параметра в поле _Состояния задания_ и использовать в качестве параметра условия в функции условия.
====

[#performers-delegate]
== Исполнители и делегирование

В окне _Исполнители и делегирование_, открывающимся при нажатии кнопки *Исполнители...*, назначаются исполнители задания и пользователи, которым задание может делегироваться в процессе исполнения (делегаты).

.Окно "Исполнители и делегирование"
image::task-performers-delegate.png[Окно "Исполнители и делегирование"]

=== Область Исполнители задания

В области _Исполнители задания_ назначается исполнитель, зарегистрированный в справочнике сотрудников (в качестве исполнителя могут быть указаны сотрудник, роль, группа или подразделение) или с помощью соответствующей переменной.

Если предполагается использовать маршрутизацию заданий, отличную от установленного для данного исполнителя по умолчанию, следует указать другой тип маршрутизации: *_Не маршрутизировать_*, *_Онлайн_*, *_Офлайн_*, *_Ссылка на задание_*, *_Письмо с описанием задания_*, *_Зашифрованное офлайн-задание_*, *_Задача Outlook_* и *_По умолчанию_*.

Задание бизнес-процесса, полученное основным исполнителем, может быть взято в работу как им самим, так и любым из его активных заместителей, указанных в справочнике сотрудников.

.Окно "Исполнитель задания"
image::task-performer.png[Окно "Исполнитель задания"]

[NOTE]
====
При назначении нескольких исполнителей задание будет исполняться альтернативно, то есть одновременно рассылаться всем исполнителям. После взятия задания в работу одним из исполнителей остальные исполнители получают соответствующее сообщение, а задание автоматически удаляется из их личных папок.
====

=== Область "Делегирование"

.В этой секции окна при помощи группы флагов следует указать:
* `*Исполнитель может делегировать задание*` -- разрешить или запретить исполнителю делегировать.
+
.Дополнительные параметры:
** `*Возможно делегирование заместителям*`.
** `*Возможно делегирование любому сотруднику*`.

Кроме того, можно составить _Список пользователей, которым можно делегировать задание_. Добавьте в список сотрудников, которым может перенаправляться задание в случае отказа исполнителя от выполнения задания. При нажатии на кнопку image:buttons/add.png[Рамка с плюсом] *Добавить* или image:buttons/edit.png[Лист с карандашом] *Редактировать* открывается диалоговое окно _Делегирование задания_, в котором следует выполнить следующие действия:

* Определить тип делегата: сотрудник, роль, группа, подразделение.
* Выбрать делегата из справочника сотрудников или с помощью переменной соответствующего типа.
* Указать, необходим ли возврат задания исполнителю, а также есть ли у делегата право на отказ от исполнения задания. +
Эти установки могут быть изменены непосредственно при делегировании.
+
* Если в процессе выполнения задания предполагается использовать тип маршрутизации заданий делегату, отличный от установленного в справочнике сотрудников по умолчанию, следует выбрать тип маршрутизации: _Письмо с описанием задания_, _Ссылка на задание_, _Онлайн_, _Офлайн_, или _Не маршрутизировать_.

[NOTE]
====
При установленном способе маршрутизации *_Офлайн_* в качестве делегата может выступать только сотрудник, явно указанный в *Списке пользователей, которым можно делегировать задание*.
====

.Окно "Делегирование задания"
image::task-delegate-window.png[Окно "Делегирование задания"]

[#links]
== Ссылки

В окне *Ссылки*, открывающемся при нажатии кнопки *Ссылки...* вкладки *Дополнительные данные*, можно добавить ссылки на файлы, папки и карточки, URL объекта, а также описать свойства документов.

image::Function_Task_Tab_Links.png[Окно "Ссылки"]

_Ссылки на файлы, папки и карточки_

Описание или редактирование параметров ссылки на какой-либо объект производится в окне *Ссылка*, открывающемся при нажатии кнопки image:buttons/add.png[Рамка с плюсом] *Добавить* (или image:buttons/edit.png[Лист с карандашом] *Редактировать*).

image::Function_Task_Tab_LinksLink.png[Окно "Ссылка"]

Для редактирования доступны перечисленные ниже опции.

Тип::
Тип ссылки (_карточка файла DV_, _карточка DV_, _папка DV_, _URL ссылка на объект_, _маршрутизируемая ссылка на объект_). При указании типа _URL ссылка_ в карточку задания добавляется ссылка на объект шлюза и далее маршрутизируется вместе с заданием. По этой ссылке объект шлюза открывается из карточки задания.
Переменная::
Объявленная переменная бизнес-процесса соответствующего типа.
Открывать только для чтения::
Определяет, будет ли документ, на который указывает ссылка, открываться только для чтения.
Необходим комментарий при сохранении::
Указывает на необходимость ввода комментария при сохранении изменений.
Назначение прав::
Позволяет ограничить возможности доступа к объекту: назначить права на чтение, на чтение и изменение или же на полный доступ; по умолчанию права не назначаются.
Комментарий::
Переменная типа _Строка_ (комментарий виден исполнителю и объясняет ему причину получения ссылки).

Права исполнителя на доступ к файлу, присоединенному к карточке задания с помощью ссылки, определяются автоматически: они совпадают с его правами доступа к карточке задания и дают ему возможность просмотра и редактирования файла. Права исполнителя на доступ к карточке, присоединенной к карточке задания с помощью ссылки, определяются пользователем самостоятельно. Для этого в {wincl}е необходимо щелкнуть по названию карточки правой кнопки мыши и выбрать из открывшегося контекстного меню команду _Безопасность_.

При добавлении ссылки на переменную бизнес-процесса типа _карточка файла DV_ и определении этой переменной при запуске экземпляра бизнес-процесса в нее можно добавить переменную типа _карточка DV_ или _файл ФС_. Если для пользователя установлен тип маршрутизации *_Письмо с описанием задания_*, то при добавлении переменной типа _файл ФС_ ему придет письмо с вложенным файлом задания. Если использовать переменную типа _карточка DV_, вложенного файла в письме не будет. При добавлении в задание ссылки на файл с переменной типа _карточка DV_ значение этой переменной в свойствах бизнес-процесса не должно быть пустым. Для _URL ссылки на объект_ должны выбираться переменные бизнес-процесса, имеющие URL-адрес: _карточка DV_, _папка DV_, _папка ФС_, _карточка файла DV_, _файл ФС_.

_Свойства документов_

Добавление или редактирование свойств прикрепленных к заданию документов производится в окне *Свойства документов*, открывающемся при нажатии кнопки image:buttons/add.png[Рамка с плюсом] *Добавить* (или image:buttons/edit.png[Лист с карандашом] *Редактировать*) соответствующей секции.

image::Function_Task_Tab_LinksPropDoc.png[Окно "Свойство документа"]

В нем доступны для добавления (редактирования) следующие поля:

Название::
Название свойства документа.
Значение::
Значение свойства документа, которое может вводиться напрямую с клавиатуры или задаваться с помощью строковой переменной бизнес-процесса.
Возвращать значение свойства в переменную процесса::

[#completion]
== Завершение задания

Окно *Завершения задания*, открывающееся при нажатии кнопки *Завершение... * на вкладке *Дополнительные данные* состоит из двух секций (*Диалог завершения* и *Условия завершения задания*) и позволяет определить параметры завершения задания.

image::Function_Task_CloseTask.png[Окно "Завершение задания"]

В секцию *Диалог завершения* сгруппированы опции, определяющие поведение задания при его завершении исполнителем.

Текст диалога завершения задания::
Помещенный в поле текст будет выводиться в заголовке диалогового окна завершения задания. Вводится с клавиатуры или задается при помощи строковой переменной бизнес-процесса типа _Строка_.
+
  При нажатии кнопки image:buttons/add.png[Рамка с плюсом] *Добавить* (или image:buttons/edit.png[Лист с карандашом] *Редактировать* -- для уже добавленных переменных) рядом с полем *Переменные, значения которых выбираются при завершении задания* открывается диалоговое окно описания переменной:
+
**Описание*: текст, вводимый с клавиатуры, или строковая переменная бизнес-процесса; параметр отображается в колонке *Имя выбора* окна *Диалог завершения задания*;
**Тип переменной*: следует выбрать тип переменной бизнес-процесса, которой после завершения задания будет возвращаться итоговое значение;
**Переменная*: следует указать объявленную переменную бизнес-процесса выбранного типа;
**Значение перечисления*;
*установкой флажков можно сделать переменную доступной только для чтения (флаг *Только для чтения*), а также обязательной при завершении задания (флаг *Обязательный*).

image::Function_Task_CloseTask_VariableSelect.png[Окно "Переменная для выбора"]

Перечисление вариантов завершения задания::
Определяет, каким образом сотрудник сможет выбрать вариант завершения задания. Поле доступно для редактирования, если в процессе объявлена переменная типа _Перечисление_. Возможны варианты нестандартного завершения задания:
+
Размещение в карточке задания дополнительных кнопок завершения задания;;
Для этого следует выбрать в поле переменную, значения которой будут выводиться в качестве кнопок завершения (если значения завершающей переменной не заданы, то на кнопках завершения не будет надписей); число кнопок завершения задания не должно превышать трех, название каждой из них может состоять не более чем из 13 знаков, в противном случае кнопкой завершения задания будет *Завершить*, а вариант завершения задания будет выбираться в раскрывающемся списке поля, расположенного слева от кнопки;
Размещение в карточке задания поля *Завершение задания* с вариантами выбора;;;
Для этого следует выбрать в поле переменную, значения которой будут выводиться в качестве опций раскрывающегося списка поля, и установить флаг *Отображать перечисление только как список*;
+
Открытие при завершении задания диалогового окна *Завершение задания*, в котором пользователю нужно будет задать значения переменных завершения;;
Для этого следует заполнить поля секции *Диалог завершения*, оставив поле *Перечисление вариантов завершения задания* пустым.
Отображать перечисление только как список::
Не показывать диалог выбора переменных завершения при завершении задания::
При установленном флаге диалог завершения задания не будет открываться автоматически. Флаг будет игнорирован при наличии в задании незаполненных обязательных значений переменных или любых переменных, зависимых от кнопок завершения; при снятом флажке диалог не будет открываться при наличии завершающей переменной.

Данная функциональность используется следующим образом: после завершения задания на экран выводится диалоговое окно *Завершение задания*, в котором исполнитель должен указать необходимые значения параметров в соответствующих полях. В зависимости от того, является ли переменная предназначенной только для чтения или требует обязательного заполнения (см. предыдущий пункт), она будет по-разному отображаться в окне *Завершение задания*: названия переменных, значения которых доступны только для чтения, отображаются на экране светло-серым шрифтом; названия переменных, которым после завершения задания обязательно должно быть присвоено некоторое значение, отображаются жирным шрифтом.

Значения параметров завершения задания можно внести в данном окне до завершения задания, для этого нажмите на панели инструментов карточки задания кнопку image:buttons/FinichTask.png[image].

[NOTE]
====
В карточке *задания Outlook* не могут быть размещены дополнительные кнопки завершения задания или поле *Завершение задания*. В этом случае из всех вариантов нестандартного завершения задания можно настроить только третий -- _открытие при завершении задания диалогового окна_ *_Завершение задания_*. Таким образом, если для задания выбран тип маршрутизации *_Задача Outlook_*, то поле *Перечисление вариантов завершения задания* всегда следует оставлять пустым.
====

В секции *Условия завершения задания* расположены флажки, определяющие условия завершения задания исполнителем:

Необходимо ввести отчет::
Указывает на обязательность ввода отчета при завершении задания. Здесь же можно определить, каким образом будет введен отчет, установив переключатели:
+
В карточку задания;;
Отчет будет прикреплен к карточке задания.
В карточку отчета;;
Будет сформирована карточка отчета.
Необходимо добавить файл::
Указывает на обязательность добавления файла в задание при его завершении. Флаг активизируется, если переключатель установлен в положении *В карточку задания*. Здесь же можно обязать исполнителя добавить определенное количество файлов, введя нужное значение с помощью счетчика.
Отсылать автору уведомление об исполнении::
Указывает, будут ли отсылаться автору автоматические уведомления о ходе исполнения задания.
Необходимо заполнение фактической трудоемкости::
При установленном флаге задание нельзя будет завершить, не указав его фактическую трудоемкость.
