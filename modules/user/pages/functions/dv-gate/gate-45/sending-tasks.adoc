= Функция рассылки задачи

.Пиктограмма функции
image::buttons/resolution.png[Лист с буквами fx и человечком]

== Общее описание функции

[NOTE]
====
_Функция рассылки задачи_ работает с карточками системы _{dv} 4.5_ и, как следствие, применяется для интеграции систем _{dv} 5_ и _{dv} 4.5_.
====

_Функция рассылки задачи_ предназначена для создания бизнес-процесса по _экземпляру_ карточки задачи (карточка приложения _Делопроизводство_ системы _{dv} 4.5_). При этом она самостоятельно Создаёт и рассылает исполнителям и контролеру задания, необходимые для её исполнения. +
Задания контролёру рассылаются только, если этот параметр указан в карточке задачи.

Кроме того, _Функция рассылки задачи_ может содержать в качестве параметра для обработки конкретную карточку задачи. Функция также может быть включена в сложный бизнес-процесс для самостоятельного создания параметров карточки задачи, что может быть вызвано событиями, происходящими во время исполнения бизнес-процесса.

[#scenarios]
== Сценарии использования

."Функция рассылки задачи" имеет два режима работы, предназначенные для решения описанных выше задач:
. Формирование заданий по вновь создаваемым карточкам задачи.
. Создание новой карточки задачи в процессе работы бизнес-процесса.

[#make-tasks]
=== Формирование заданий по вновь создаваемым карточкам задач

Для адекватного и своевременного формирования заданий по вновь создаваемым карточкам задачи необходимо, чтобы в системе постоянно находился активный экземпляр бизнес-процесса, назначением которого являлось бы обнаружение активизированных карточек задачи и создание бизнес-процессов для их исполнения.

Этот бизнес-процесс может устанавливаться автоматически при инсталляции системы или вручную после её установки.

.Схема работы функции в этом режиме выглядит следующим образом:
* Активизация карточки задачи делает её "видимой" для функции рассылки задачи в режиме обработки новых активных карточек задач. Функция Создаёт бизнес-процесс исполнения задачи в соответствии с параметрами, описанными в карточке.
* При этом формируются отдельные задания для каждого из исполнителей, а также для контролера (если этот параметр указан в карточке задачи).

.Бизнес-процесс обнаружения активизированных карточек задач
image::bp-detect-resolution.png[Бизнес-процесс обнаружения активизированных карточек задач]

[#make-task]
=== Создание новой карточки задачи в процессе работы бизнес-процесса

В режиме создания карточки задачи функция Создаёт бизнес-процесс, предназначенный для рассылки заданий в соответствии с параметрами экземпляра карточки задачи. +
Бизнес-процесс может формироваться функцией самостоятельно в соответствии с указанными в ней параметрами, создаваться по имеющемуся в системе шаблону или порождаться универсальной функцией бизнес-процесса. При выполнении функции её полям будут передаваться значения при помощи универсального обмена данными.

[#parameter-settings]
== Настройка параметров

.Свойства "Функции рассылки задачи". Вкладка "Параметры"
image::resolution-properties.png[Свойства "Функции рассылки задачи". Вкладка "Параметры"]

.На вкладке "Параметры" окна свойств функции указываются параметры формирования заданий по исполнению задачи:
Режим обработки новых активных задач::
Флаг переводит функцию в режим обнаружения активизированных карточек задачи. В этом режиме функция входит в состав простого бизнес-процесса, один экземпляр которого должен быть активным постоянно. Когда флаг установлен, все остальные поля функции становятся недоступны.
+
Во всех остальных случаях использования функции поля заполняются параметрами, которые могут указываться как явно, так и при помощи переменных бизнес-процесса. При этом в выпадающих списках для выбора доступны только переменные типов, соответствующих типу поля. Все поля сгруппированы в две секции.

Создание карточки::
В секции описываются данные создаваемой карточки.
+
.Секция состоит из следующих полей:
* _Задача_.
* _Название_.
* _Регистратор_.
* _Контролер_.
* _Ответственный исполнитель_.
* _Исполнители_.
* _Карточки документов_.
* _Карточки файлов_.
* _Дата начала_.
* _Дата завершения_.
* _Дата контроля_;
* _Длительность (час.)_.
* _Подписано_.
* _Дата подписания_.
* _Вариант исполнения_. Поле должно содержать переменную (значение) целого типа, при этом `0` предполагает параллельный вариант исполнения задания, `1` -- последовательный, `2` -- альтернативный.
* _Высокая срочность_.
* _Содержание_.
* _Папка карточки_ -- папка, в которую помещается формируемая карточка задачи.
* _Папка процесса_ -- папка, в которую будет помещен экземпляр процесса, созданного по формируемой карточке задачи.
* _Период опроса_.

В секции _Результат исполнения_ описываются результаты работы функции. В неё входит единственное поле, в котором указывается _Дата реального завершения_ выполнения заданий, включаемых в формируемую карточку задачи.
