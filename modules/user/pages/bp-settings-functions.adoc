= Добавление функций БП

На левой панели карточки бизнес-процесса расположена палитра с пиктограммами функций, которые сгруппированы по принадлежности (базовые функции, функции шлюза с {dv}, функции шлюза с файловой системой и функции шлюза к почтовой системе).

.Палитра функций конструктора бизнес-процессов
image::bp-designer-functions.png[Палитра функций конструктора бизнес-процессов]

* Чтобы раскрыть список функций группы, нажмите на кнопку с её названием.
* Чтобы добавить функцию в бизнес-процесс:
** Нажмите на пиктограмму в функциональной области.
** Нажмите правой кнопкой мыши по области графа, в открывшемся контекстном меню выберите название функции.

По умолчанию пиктограмма функции в области графа носит название, совпадающее с основным названием. Переименовать функцию можно в окне её свойств.

.Чтобы переместить пиктограмму функции по области графа:
* Нажмите левой кнопкой мыши на пиктограмму функции. При этом пиктограмма будет выделена квадратами по периметру и в центре.+
Можно выделить сразу несколько функций, удерживая нажатой клавишу kbd:[Shift] и нажимая последовательно на их пиктограммы. При этом все выделенные функции будут отмечены квадратами.
* Разместите курсор над пиктограммой. Когда курсор примет форму крестика со стрелками, нажмите левую кнопку мыши, и переместите пиктограмму в нужное место.+
Аналогичным образом перемещается группа выделенных пиктограмм вместе со связывающими их переходами.

.Чтобы изменить размер пиктограммы функции:
* Нажмите левой кнопкой мыши на пиктограмму функции. При этом пиктограмма будет выделена квадратами по периметру и в центре.
* Поместите курсор над одним из квадратов, расположенных по периметру пиктограммы, при этом курсор должен принять форму штриха со стрелками.
* Нажмите левую кнопку мыши и, удерживая ее, придайте пиктограмме требуемые форму и размер.

Свойства и примеры настройки функций приведены в Приложениях.

[#connections]
== Настройка связей между функциями БП

Связи между функциями БП определяют порядок передачи управления бизнес-процессом от одной функции к другой.

.Чтобы установить связь между функциями, выполните следующие действия:
. Выделите пиктограмму функции, нажав на неё правой кнопкой мыши. Нажмите левой кнопкой мыши на пиктограмму функции. При этом пиктограмма будет выделена квадратами по периметру и в центре.
. Разместите курсор над центральным квадратом, при этом он должен принять форму крестика (без стрелок).
. Нажмите левую кнопку мыши и, удерживая ее, проведите отрезок к функции, к которой необходимо осуществить переход.

По умолчанию связь между функциями не имеет названия и изображается прямым серым отрезком со стрелкой, а передача управления бизнес-процессом от предыдущей функции к последующей происходит при успешном завершении первой из них.

Определить свойства, отличающиеся от установленных по умолчанию для каждой из связей можно в специальном диалоговом окне. Чтобы открыть данное окно, нажмите на нужную связь правой кнопкой мыши и выберите из открывшегося контекстного меню команду _Свойства_.

.Окно свойств связи между функциями
image::bp-functions-connections.png[Окно свойств связи между функциями]

На единственной вкладке этого окна доступны для редактирования свойства связей между функциями.

Название::
Указанное здесь название связи будет выводиться на экране, если нажата кнопка *Показывать метки переходов*.

Описание::
Комментарий, описывающий назначение связи и любые другие дополнительные сведения.

Стиль::
В поле выбирается тип линии, иллюстрирующей связь:
+
.Описание типов линий
[cols="20%,80%",options="header"]
|===
|Стиль |Описание

|*_Прямая_* 
a|
Тип линии, устанавливаемый по умолчанию.

При определении связи она изображается единственным отрезком со стрелкой.

.Чтобы изобразить связь в виде ломаной линии произвольной формы, выполните следующие действия:
. Выделите связь нажатием левой кнопкой мыши.
. Поместите курсор над квадратом, расположенным посередине отрезка, изображающего связь. При этом курсор должен принять форму крестика.
. Нажмите левую кнопку мыши и переместите курсор в желаемую точку. +
Переход между функциями превратится в ломаную линию, состоящую из двух отрезков.
+
. Середина обоих вновь образованных отрезков будет отмечена квадратом, каждый из которых можно сделать новой вершиной ломаной линии. Процесс можно продолжать, придавая связи любую форму.

|*_Дуга_*
|Позволяет представить переход между функциями в виде дуги.

|*_Кривая_*
|Аналогична дуге, но позволяет создавать более сложные графические формы способом, описанным для *_Прямой_*.
|===
+
Тип::
Указывает условие передачи управления бизнес-процессом от предыдущей функции к последующей. Связь может быть одного из указанных в таблице типов.
 +
.Описание типов связей
[cols="20%,80%",options="header"]
|===
|Стиль |Описание

|*_При успехе_*
|Передача управления следующей функции происходит при успешном завершении предыдущей.

Линия имеет серый цвет.

|*_При ошибке_*
|Передача управления следующей функции происходит при завершении предыдущей по ошибке.

Линия имеет красный цвет.

|*_При завершении_*
|Передача управления следующей функции происходит при завершении предыдущей функции вне зависимости от результата (успешного или по ошибке).

Линия имеет синий цвет.

|*_При успехе связанной функции_*
|Передача управления следующей функции происходит при успешном выполнении связанной функции.
|===

Тип функции::
Поле активно только если в качестве типа связи в предыдущем поле указано значение `*При успехе связанной функции*`.
+
--
.Доступны следующие типы функций:
* *_Задание_*.
* *_Задание 5_*.
* *_Мониторинг {dv}_*.
* *_Мониторинг файловой системы_*.
* *_Подпроцесс_*.
* *_Расписание_*.
* *_Сценарий_*.
* *_Условие_*.
--
+
Если выбрана одна из этих функций, становится доступной кнопка *Функция...*. По её нажатию появляется окно свойств соответствующей функции. Использование типа *_При успехе связанной функции_* имеет следующее применение: помимо штатного завершения текущей функции возможен альтернативный переход к другой функции при наступлении определенного события. В роли события как раз выступает успешное выполнение связанной функции.
+
В примере ниже показан простой бизнес-процесс, в котором используется условие альтернативного перехода из функции.
+
.Пример бизнес-процесса с использованием типа связи "При успехе связанной функции"
image::bp-functions-connection-sample.png[Пример бизнес-процесса с использованием типа связи "При успехе связанной функции"]
+
В показанном примере выполнение связанной функции _Расписание_ -- это событие, по которому функция _Задание_ передаст управление функции _Управление заданием_. Для этого в окне свойств условия нужно сделать следующие настройки:
+
.Окно параметров связи и связанной функции
image::bp-functions-connection-related.png[Окно параметров связи и связанной функции]
+
Таким образом, если задание будет завершено до указанного в расписании срока, будет произведен штатный выход из функции, если нет -- будет передано управление функции _Управление заданием_.
+
В карточке бизнес-процесса связь, указывающая на связанную функцию, отображается пунктирной линией.
