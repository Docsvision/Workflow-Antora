=  Функция рассылки согласования

== Пиктограмма функции

image:Buttons/Function_Approval.png[image]

== Общее описание функции

[NOTE]
====
[.note__title]#Прим.:# [.keyword]*Функция рассылки согласования* работает с карточками системы [.dfn .term]_Docsvision 4.5_ и, как следствие, применяется для интеграции систем [.dfn .term]_Docsvision 5_ и [.dfn .term]_Docsvision 4.5_.
====

[.keyword]*Функция рассылки согласования* предназначена для формирования бизнес-процесса по активизированной карточке согласования (карточка приложения [.dfn .term]_Делопроизводство_ системы [.dfn .term]_Docsvision 4.5_). При этом она самостоятельно создает и рассылает согласующим лицам задания, необходимые для согласования документа (документов).

Кроме того, [.keyword]*Функция рассылки согласования* может содержать в качестве параметра для обработки конкретную карточку согласования или же быть включена в сложный бизнес-процесс для самостоятельного создания параметров карточки согласования, что может быть вызвано событиями, происходящими во время исполнения бизнес-процесса.

== Сценарии использования

[.keyword]*Функция рассылки согласования* имеет два режима работы, предназначенные для решения описанных выше задач:

. Формирование заданий по вновь создаваемым карточкам согласования.
. Создание новой карточки согласования в процессе работы бизнес-процесса.

[.keyword .parmname]_Формирование заданий по вновь создаваемым карточкам согласования_

Для адекватного и своевременного формирования заданий по вновь создаваемым карточкам согласования необходимо, чтобы в системе постоянно присутствовал активный экземпляр бизнес-процесса, назначением которого являлось бы обнаружение активизированных карточек согласования и создание бизнес-процессов для их исполнения.

Этот бизнес-процесс может устанавливаться автоматически при инсталляции системы или вручную после ее установки. Схема работы функции в этом режиме выглядит следующим образом:

* Активизация карточки согласования делает ее «видимой» для функции рассылки согласования в режиме обработки новых активных карточек согласования, которая создает бизнес-процесс согласования в соответствии с параметрами, описанными в карточке.
* При этом формируются отдельные задания для каждого из согласующих лиц, а также для регистратора (если этот параметр указан в карточке согласования).
* Завершает формируемый бизнес-процесс опять-таки функция рассылки согласования, которая оценивает результаты цикла и, в зависимости от полученной оценки, выполняет одно из следующих действий:
** формирует бизнес-процесс для запуска еще одного цикла согласования;
** создает ссылки на результирующие документы;
** рассылает уведомления о ходе согласования;
** завершает согласование.

image::Example_of_Functions_Approval.png[[.fig--title-label]#Рис. 1. # Бизнес-процесс обнаружения активизированных карточек согласования]

[.keyword .parmname]_Создание новой карточки согласования в процессе работы бизнес-процесса_

В режиме создания карточки согласования функция может создавать задания по согласованию, используя как уже существующую карточку согласования, так и формируя ее самостоятельно (после создания новой карточки, например, при помощи универсальной функции).

== Настройка параметров

image::Parameters_Approval.png[[.fig--title-label]##Рис. 2. ##Свойства "Функции рассылки согласования". Вкладка "Параметры"]

На вкладке [.keyword]*Параметры* окна свойств функции указываются параметры формирования заданий по согласованию.

Режим обработки новых активных согласований::
  Флаг переводит функцию в режим обнаружения активизированных карточек согласования. В этом режиме функция входит в состав простого бизнес-процесса, один экземпляр которого должен быть активным постоянно. При установленном флаге все остальные поля функции становятся недоступными.

Во всех остальных случаях использования функции поля заполняются параметрами, которые могут указываться как явно, так и при помощи переменных бизнес-процесса; при этом в выпадающих списках для выбора доступны только переменные типов, соответствующих типу поля. Все поля сгруппированы в две секции.

Создание карточки::
  В секции описываются данные создаваемой карточки; она состоит из следующих полей (назначение большинства из них не нуждается в отдельных комментариях):
  +
  * [.keyword]*Карточка согласования*.
  * [.keyword]*Название*.
  * [.keyword]*Регистратор*.
  * [.keyword]*Инициатор*.
  * [.keyword]*Ответственное лицо*.
  * [.keyword]*Согласующие лица*.
  * [.keyword]*Карточки файлов*.
  * [.keyword]*Разрешить редактирование документов*.
  * [.keyword]*Разрешить просмотр замечаний к документам*.
  * [.keyword]*Дата начала*.
  * [.keyword]*Дата завершения*.
  * [.keyword]*Последовательное согласование*.
  * [.keyword]*Папка карточки* – папка, в которую будет помещена формируемая карточка согласования.
  * [.keyword]*Папка процесса* – папка, в которую будет помещен экземпляр бизнес-процесса, сформированного по созданной карточке согласования.
  * [.keyword]*Период опроса (мин)*.
Результат согласования::
  В секции описываются результаты работы функции; ее составляют следующие поля:
  +
  * [.keyword]*Согласованные документы*.
  * [.keyword]*Дата реального завершения*.
  * [.keyword]*Статус согласования*.

*На уровень выше:* xref:Function_Gate_Docsvision45.adoc[Функции шлюза к Docsvision 4.5]
