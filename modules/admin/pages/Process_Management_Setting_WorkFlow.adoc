= Настройка СУБП

Индивидуальная настройка каждого сервиса WorkFlow производится в диалоговом окне [.keyword .wintitle]*WorkflowService*.

image::sc_wfpage_serviceconfig.png[Окно настройки сервиса Workflow]

Для проведения настройки выполните следующие действия:

. Откройте __{cns}__, перейдите к ветке *модули расширения/{wf}*.
+
Будет открыто окно *{wf}*.
. Выделите в списке сервис, параметры которого подлежат настройке, и нажмите кнопку *Изменить*.
. В секции *Настройки сервиса* укажите:
* *Имя службы*; название службы по умолчанию - _{dv} 5.5 Workflow Server_; оно доступно для изменения.
* *Тип запуска* определяет способ активизации службы – автоматически при запуске компьютера, вручную в любой момент времени или же служба отключена.
* *Учетная запись*, под которой будет работать сервер бизнес-процессов. Эта учетная запись должна входить в группы пользователей "{dv} Power Users" и "{dv} Workflow Process Creators", а также иметь доступ к профилю для работы с Microsoft Exchange Server (следующая группа настроек). Каждому сервису может соответствовать только одна учётная запись.
* *Пароль* -- пароль учетной записи службы управления процессами.
+
Настройки этой группы параметров доступны как из _Консоли настройки {dv}_, так и в списке сервисов, доступном при выборе в главном меню Windows menu:Пуск[Настройки > Панель управления > Администрирование > Сервисы].

[NOTE]
====
Изменение учетной записи, под которой работает сервер бизнес-процессов, следует производить только из _Консоли настройки {dv}_. Изменение учетной записи в окне [.keyword .wintitle]*Сервисы* управления компьютером приведет к противоречивости настроек и может стать причиной сбоя в работе системы.
====
. В секции *Параметры восстановления* укажите параметры перезапуска сервера управления процессами в случае некорректной работы, а именно: #
* при необходимости установите флаг *Перезапускать службу при первом неудачном старте*;
* в поле *Задержка перед перезапуском <...> сек* укажите время в секундах;
* в поле *Очищать счетчик попыток через <...> сек* укажите время в секундах.
. Группа управляющих элементов *Параметры управления* описывает периодичность работы сервера управления процессами:
* *Период поиска процессов (сек)* – пауза между проведением Workflow поиска новых активных процессов;
* *Максимальный объем памяти (Мб)* представляет собой объем _физической_ памяти, выделенной серверу управления процессами; по умолчанию его значение равно 512 МБ. Если почему-либо значение параметра нужно изменить, то следует принять во внимание ограничения:
** в редакциях {dv} x86 значение параметра можно устанавливать любым, однако процесс ExecLogic.exe в любом случае не сможет задействовать более 1,75 ГБ оперативной памяти и при превышении этого значения примет решение о перезагрузке;
** в редакциях {dv} x64 значение параметра можно устанавливать любым, в зависимости от объёма доступной физической памяти. При этом процесс ExecLogic32.exe в любом случае не сможет задействовать более 1,75 ГБ оперативной памяти и при превышении этого значения примет решение о перезагрузке, а процесс ExecLogic.exe сможет задействовать весь выделенный ему объём оперативной памяти;
* *Предел таймаутов функций* – максимально допустимое число таймаутов. Если разрешенный лимит превышен, то рабочий процесс (ExecLogic) примет решение о перезагрузке, а процессы с превышенным временем обработки будут передвинуты в конец очереди ожидающих обработки процессов;
* *Время ожидания выполнения функции в потоке (сек)* – период, за который должна выполниться функция; этот период используется, если в настройках функции в поле *Период опроса* не указан другой интервал;
* *Число процессов в пакете* – максимальное количество параллельно обрабатываемых бизнес-процессов;
* *Размер пула шлюза*, где пул шлюзов – это совокупность параллельно работающих экземпляров шлюзов одного типа с одинаковыми настройками, выделяемых для обработки процессов;
* *Размер пула сессий*, где пул сессий – это совокупность параллельно работающих сессий с одинаковыми настройками подключения, выделяемых для обработки процессов;
* *Время ожидания выполнения метода Storage Server (сек)* – период ожидания ответа сервера, после которого возвращается сообщение об ошибке `Сервер                             недоступен`;
* если установлен флаг *Режим изоляции процесса*, то каждому обрабатываемому процессу будет выделяться личная сессия и личный набор шлюзов, которые на время обработки процесса будут находиться в его эксклюзивном использовании. Режим необходим для того, чтобы задержки и блокировки, возникающие в сессии/шлюзе из-за использования их неким процессом, по возможности (зависит от реализации шлюза) не влияли на другой процесс.
+
[NOTE]
====
Используемые по умолчанию настройки сервиса WorkFlow оптимальны для большинства случаев. Менять их рекомендуется только после консультации со службами технической поддержки или консалтинга _{dv}_.
====
. В секции *Прочие параметры* укажите дополнительные настройки сервера управления процессами: #
* *Порт для удаленных вызовов* содержит значение порта для удаленного доступа к серверу; поле получает значение по умолчанию при инсталляции системы (хотя и доступно для изменения);
* в поле *Имя файла журнала* можно указать путь к файлу, в котором будут фиксироваться все события, происходящие на сервере управления процессами. При корректной работе сервера ведение журнала не обязательно, однако в случае его нестабильной работы журнал может помочь выяснить неполадки и устранить их. Для ведения журнала у учетной записи сервиса Workflow должны быть права на папку, в которой создается журнал;
+
[NOTE]
====
Журнал является средством диагностики при возникновении нештатных ситуаций и предназначен для передачи в службу технической поддержки; анализ содержимого журнала пользователем или администратором не предполагается. Кроме этого журнала служба технической поддержки может запросить другие данные, которые могут оказаться полезными при анализе нештатных ситуаций.
====
* если предполагается вести журнал, то в поле *Уровень журналирования* следует указать глубину фиксации процессов ([.kbd .ph .userinput]`Выключено`, [.kbd .ph .userinput]`Ошибки`, [.kbd .ph .userinput]`Предупреждения`, [.kbd .ph .userinput]`Информация`, [.kbd .ph .userinput]`Отладочные сообщения`). Каждый последующий уровень журналирования включает в себя сообщения предыдущих уровней. Таким образом, включение режима [.kbd .ph .userinput]`Отладочные сообщения` будет означать так же фиксацию сообщений об ошибках, предупреждениях и информационных сообщениях.
+
[NOTE]
====
Если выбран уровень журналирования с высокой детализацией, то за небольшой промежуток времени размер журнала может существенно увеличиться. Таким образом, устанавливать уровень журналирования [.kbd .ph .userinput]`Отладочные сообщения` рекомендуется только при возникновении проблем в работе подсистемы Workflow или по просьбе технической поддержки {dv}.
====
* в поле *Формат даты в имени журнала* задается шаблон (маска) для вывода даты файла журнала в его имени (устанавливающаяся по умолчанию маска даты yyMMdd может быть изменена на другую, соответствующую стандарту ISO 8601). Если формат даты задан, то в 0:00 вывод сообщений переадресуется в новый файл журнала, имя которого образуется как *ИмяДоПервойТочкиОтформатированнаяДата.ИмяПослеПервой точки*; если рассматриваемое поле очищено, журнал сервиса продолжает вестись в прежнем файле; указанный в поле формат даты автоматически заносится в реестр в параметр LogFileDateTemplate;
* кнопка *Сбросить счетчики* обнуляет содержимое счетчиков объекта {dv} WorkFlow в Performance Monitor.
. В состав последней секции входят кнопки управления сервисом: *Запустить*, *Перезапустить* и *Остановить*.
. Нажмите кнопку *ОК* (форма будет закрыта) или *Применить* для применения настроек. Сервис "WorkFlow" будет перезапущен с новыми настройками.
