= Сущности модуля

[#bp]
== Бизнес-процесс, шаблон и экземпляр БП

Бизнес-процесс организации представляет собой систематизированное последовательное исполнение функциональных операций, приводящее к специфическому результату. Детализация и формализация такой цепочки, а также её последующее описание при помощи модуля _{wf}_ позволяет автоматизировать многие аспекты бизнес-процесса.

Как правило, предназначенный для автоматизации бизнес-процесс -- это относительно часто повторяющаяся последовательность действий, которая инициируется, в общем случае, каким-либо событием. Например, событием является появление какого-либо документа, требующего обработки, или наступление определенной даты. В связи с этим при формализации и описании бизнес-процесса следует выделить подобные последовательности, а затем создать по ним шаблоны. Шаблоны в дальнейшем будут использоваться для создания отдельных экземпляров бизнес-процессов -- специфических "программ", берущих на себя определенные функции по организации документооборота. Так, например, экземпляр бизнес-процесса может автоматически обнаружить вновь созданную карточку исходящего договора, отправить его копии должностным лицам, с которыми необходимо согласовать договор, одновременно извещая сотрудника, ответственного за окончательное согласование и подписание договора.

Таким образом все основные параметры -- последовательность и условия передачи управления бизнес-процессом от одной функции к другой, все переменные для обмена данными между функциями и задания, предназначенные для выполнения сотрудниками организации, -- все это определяется в карточке шаблона бизнес-процесса, по сути своей являющейся формализацией какой-либо принятой в организации процедуры. Сюда также относятся специфические переменные, которыми оперирует только какой-либо определенный шлюз, а также переменные, значения которых необходимо указывать каждый раз при создании экземпляра.

Для описания шаблона бизнес-процесса предусмотрена особая карточка -- карточка бизнес-процесса, изменение которой выполняется в _Конструкторе бизнес-процессов_. Описание данного инструмента приведено в разделе xref:user:bp-designer.adoc[Конструктор бизнес-процессов].

.Конструктор бизнес-процессов
image::user:bp-designer-regular.png[Конструктор бизнес-процессов]

Запуск бизнес-процесса приводит к созданию его экземпляра, предназначенного для обработки какого-либо конкретного события, уже произошедшего или ожидаемого. Обычно действие экземпляра ограничивают временным интервалом (в общем случае он может оказаться достаточно длительным) или событием (которое, теоретически, может так и не произойти, поэтому ограничительные временные рамки рекомендуется ставить в любом случае). На рисунке выше приведен пример простейшего бизнес-процесса, состоящего только из начальной и конечной функций: при создании экземпляра такого бизнес-процесса активизируется начальная функция (производится запуск экземпляра), которая передает управление БП конечной функции, завершающей работу экземпляра.

По одному шаблону бизнес-процесса может быть одновременно создано и запущено неограниченное количество независимых экземпляров, каждый из которых занимается обработкой отдельного события.

[#vars]
== Переменные

Переменные модуля _{wf}_ предназначены для хранения, передачи и обмена данными между функциями в ходе выполнения БП.

Основной характеристикой переменной БП является её тип. Тип переменной влияет на то, какие значения она может принимать и в каких функциях её можно использовать. Переменная может быть простого или специализированного типа:

* Простые типы переменных аналогичны типам, используемым в языках программирования, например: целочисленные, дробные, строковые и др.
* Специализированные типы переменных -- типы, которыми оперируют шлюзы и при помощи которых осуществляется корректный обмен информацией между приложением и внешними системами: файловой системой, библиотекой карточек {dv}, почтовой программой, а также другими системами, с которыми установлен шлюз.

Все типы переменных перечислены в xref:user:variable-types.adoc[Приложении A].

Модуль _{wf}_ не гарантирует корректное преобразование переменных одного типа в другой -- данная функция должна быть реализована сотрудником, который настраивает БП, например, в коде функции "Сценарий". Преобразование некоторых типов переменных может производиться автоматически посредством функций обмена данными между переменными и универсального обмена данными.

[#functions]
== Функции бизнес-процесса

_Функции_ модуля _{wf}_ предназначены для поэтапного описания бизнес-процесса. Выполнение бизнес-процесса заключается в вызове составляющих его функций, которые по мере завершения передают друг другу управление БП в соответствии с установленными между ними связями. _Функции_ могут быть связаны между собой последовательно, параллельно или последовательно-параллельно прямыми или условными переходами. Назначение и сложность функций весьма различны: функция может, например, просто задержать продолжение выполнения процесса до определенного момента, а может самостоятельно создать сложный бизнес-процесс.

.Функции модуля _{wf}_ делятся на две группы:
* Базовые функции -- общие функции модуля. Описание базовых функций приведено в разделе _Базовые функции_ xref:user:functions/initial.adoc[Приложении B].
* Специальные функции, которые предоставляют _шлюзы_. Описание функций шлюзов -- в xref:user:functions/dv-gate/functions.adoc[Приложении C], xref:user:functions/fs-gate/filesystem-gate.adoc[Приложении D] и xref:user:functions/mail-gate/mailgate.adoc[Приложении E].

_Шлюзы_ предоставляют функции, которые выполняются не сразу после передачи управления, а при возникновении определенного события в системе, к которой настроен шлюз. Примером такого события является появление новой карточки в папке или изменение значения переменной. За получением более подробной информации обратитесь к разделу <<monitoring,Функции мониторинга за объектами шлюза>>.

[#gates]
== Шлюзы

_Шлюз_ представляет собой программный компонент, предназначенный для обеспечения взаимодействия модуля _{wf}_ с внешними системами.

.В составе модуля предоставляются следующие шлюзы:
* Шлюз к {dv}: обеспечивает интеграцию модуля _{wf}_ с объектами других приложений и модулей системы {dv}.
* *Шлюз к файловой системе*: предоставляет приложению доступ к файловой системе.
* *Шлюз к простым типам*: предоставляет доступ к базовым функциям.
* *Шлюз к почтовой системе*: позволяет модулю осуществлять мониторинг и обмен данными с почтовым ящиком пользователя, а также создавать и отправлять почтовые сообщения.

.Шлюзы позволяют расширить функциональность модуля, обеспечивая ему следующие возможности:
* Мониторинг событий, происходящих в системе, с которой установлен _шлюз_.
* Обмен данными между приложением и системами, с которыми установлен _шлюз_.
* Создание и отправка заинтересованному пользователю ссылки на объект внешней системы, с которой установлен _шлюз_.
* Специализированную обработку БП объекта внешней системы, с которой установлен _шлюз_.

Каждый шлюз оперирует собственными типами переменных, позволяющими описывать объекты внешних систем, с которыми взаимодействует бизнес-процесс, а также включает собственные функции, способные обрабатывать эти объекты: копировать, удалять, создавать новые, модифицировать существующие и т. д. Подобное взаимодействие значительно расширяет функциональность системы, позволяя ей манипулировать объектами других систем. В значительной степени упрощает обмен значениями между переменными шлюзов xref:user:functions/basic/universal-data-exchange.adoc[функция универсального обмена данными].

[#monitoring]
=== Функции мониторинга за объектами шлюза

_Мониторингом_ в системе {dv} будем называть наблюдение за состоянием объектов или процессов с целью их оценки или контроля. Мониторинг осуществляется при помощи особых функций, позволяющих обнаруживать уже имеющиеся объекты, новые объекты, а также происходящие с ними изменения.

Каждый из шлюзов модуля _{wf}_ включает собственную функцию мониторинга, специализированную для наблюдения за событиями в соответствующей внешней системе. Как только функция мониторинга обнаруживает объект или событие, указанные в её параметрах, она передает управление БП по исходящей связи (или одной из исходящих связей, удовлетворяющих условию). Следует отметить, что все функции мониторинга остаются активными вплоть до обнаружения нужного события. Чтобы избежать "повисания" функции (в случае, если событие так и не произойдет), можно либо указать связь, которую следует активизировать в случае неудачи мониторинга, либо ограничить срок её действия, задавая параллельно с ней функцию расписания с однократным срабатыванием через какое-либо время (или в какой-либо определенный момент), что приведет -- в зависимости от назначения бизнес-процесса -- либо к его завершению, либо к передаче управления далее по исходящим связям.

Кроме того, возможно включение функций мониторинга в цикл для ожидания повторного события, соответствующего параметрам функции. При этом функция мониторинга может быть ограниченной по времени или одновременно передавать управление на следующий цикл слежения и на другую ветку продолжения бизнес-процесса для обработки обнаруженного события.

В качестве переменной функциям мониторинга может указываться переменная-коллекция с типом элементов, соответствующих шлюзу, к которому относится функция. В данном случае все обнаруженные элементы будут собраны в одной переменной, которую впоследствии можно обработать нужным образом.

[#initiating]
== Инициирующий документ

Инициирующим называется документ, из карточки которого создается экземпляр какого-либо БП. Тип инициирующего документа, указываемого в настройках БП, -- тип документа, из которого могут создаваться экземпляры БП. Например, если в свойствах шаблона БП в качестве инициирующего документа указан внутренний документ, то данный шаблон может использоваться для создания экземпляра БП непосредственно из карточки внутреннего документа.
